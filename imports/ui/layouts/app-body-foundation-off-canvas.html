<template name="App_body">
    {{#HammerTouchArea gestureMap=templateGestures}}

        <div class="off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

                <!-- off-canvas title bar for 'small' screen -->
                <div class="title-bar" data-responsive-toggle="widemenu" data-hide-for="medium">
                    <div class="title-bar-left">
                        <a href="{{pathFor 'static.home'}}"><span class="title-bar-title">[logo]</span></a>
                    </div>
                    <div class="title-bar-right">
                        <button class="menu-icon" type="button" data-open="offCanvasRight"></button>
                    </div>
                </div>

                <!-- off-canvas right menu -->
                <div class="off-canvas position-right" id="offCanvasRight" data-off-canvas data-position="right">

                    <button class="float-right push-down-small padded" aria-label="Close menu" type="button" data-close>
                        <span class="" aria-hidden="true">X</span>
                    </button>

                    <ul class="vertical menu text-center">

                        {{#if currentUser}}

                            <li class="{{isActiveRoute 'profile.page'}}">
                                <a href="{{pathFor 'profile.page' username=currentUsername}}" class="" data-close>{{currentUsername}}</a>
                            </li>
                            <li class="{{isActiveRoute 'profile.projects'}}">
                                <a href="{{pathFor 'profile.projects' username=currentUsername}}" data-close>My projects</a>
                            </li>

                        {{else}}
                            <div class="menu button-group expanded">
                                <li>
                                    <a href="{{pathFor 'signin'}}" class="button primary hollow" data-close>{{_ 'Sign In'}}</a>
                                </li>
                                <li>
                                    <a href="{{pathFor 'join'}}" class="button primary hollow" data-close>{{_ 'Join'}}</a>
                                </li>
                            </div>
                        {{/if}}

                        <li class="{{isActiveRoute 'explore.page'}}" data-close><a href="{{pathFor 'explore.page'}}">Explore</a></li>
                        <li class="{{isActiveRoute 'static.make'}}" data-close><a href="{{pathFor 'static.make'}}">Make art</a></li>
                        <li class="{{isActiveRoute 'static.about'}}" data-close><a href="{{pathFor 'static.about'}}">About</a></li>
                        <li class="{{isActiveRoute 'static.donate'}}" data-close><a href="{{pathFor 'static.donate'}}">Donate</a></li>

                        {{#if currentUser}}
                            <li><a class="js-logout" data-close>{{_ 'logout'}}</a></li>
                        {{/if}}

                    </ul>
                </div>

                <!-- "wider" top-bar menu for 'medium' and up -->
                <div id="widemenu" class="top-bar">
                    <div class="top-bar-left">
                        <ul class="menu">
                            <li><a href="{{pathFor 'static.home'}}">[logo]</a></li>
                            <li class="{{isActiveRoute 'explore.page'}}"><a href="{{pathFor 'explore.page'}}">Explore</a></li>
                            <li class="{{isActiveRoute 'static.make'}}"><a href="{{pathFor 'static.make'}}">Make art</a></li>
                            <li class="{{isActiveRoute 'static.about'}}"><a href="{{pathFor 'static.about'}}">About</a></li>
                        </ul>
                    </div>
                    <div class="top-bar-right">
                        {{#if currentUser}}
                            <ul class="dropdown menu" data-dropdown-menu>
                                <li class="has-submenu">
                                    <a href="{{pathFor 'profile.page' username=currentUsername}}" class="js-user-menu btn-secondary">
                                        {{currentUsername}}
                                    </a>

                                    <ul class="submenu menu vertical" data-submenu>
                                        <!--<li>
                                            <a href="{{pathFor 'profile.page' username=currentUsername}}"
                                               class="btn-secondary">{{_ 'My profile'}}</a>
                                        </li>-->
                                        <li>
                                            <a href="{{pathFor 'profile.projects' username=currentUsername}}">My projects</a>
                                        </li>
                                        <li>
                                            <a href="{{pathFor 'static.donate'}}" class="btn-secondary">{{_ 'Donate'}}</a>
                                        </li>
                                        <li>
                                            <a class="js-logout btn-secondary">{{_ 'Logout'}}</a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        {{else}}
                            <div class="menu button-group">
                                <li>
                                    <a href="{{pathFor 'signin'}}" class="button secondary hollow">{{_ 'Sign In'}}</a>
                                </li>
                                <li>
                                    <a href="{{pathFor 'join'}}" class="button secondary hollow">{{_ 'Join'}}</a>
                                </li>
                            </div>
                        {{/if}}

                    </div>
                </div>

                <!-- original content goes in this container -->
                <div class="off-canvas-content" data-off-canvas-content>
                    <div class="row column">
                        {{#unless connected}}
                            <div class="notifications">
                                <div class="notification">
                                    <span class="icon-sync"></span>
                                    <div class="meta">
                                        <div class="title-notification">Trying to connect</div>
                                        <div class="description">There seems to be a connection issue</div>
                                    </div>
                                </div>
                            </div>
                        {{/unless}}

                        <div class="content-overlay"></div>

                        <div id="content-container">
                            {{#momentum plugin="fade"}}
                                {{#if Template.subscriptionsReady}}
                                    {{> Template.dynamic template=main}}
                                {{else}}
                                    {{> App_loading}}
                                {{/if}}
                            {{/momentum}}
                        </div>
                    </div>
                </div>

                <!-- close wrapper, no more content after this -->
            </div>
        </div>

    {{/HammerTouchArea}}
</template>
